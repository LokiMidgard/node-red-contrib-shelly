<!-- Created by Karl-Heinz Wind -->
<!-- see also // https://shelly-api-docs.shelly.cloud/#common-http-api -->


<!-- GEN 1 ------------------------------------------------------------------------------------ -->

<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-switch', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            pollinginterval: { value: 5000 },
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "switch",
        label: function () {
            return this.description || this.hostname || "Shelly switch";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-switch">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>
</script>

<script type="text/x-red" data-help-name="shelly-switch">
    <p>A node that controls a shelly switch device (Shelly 1, 1PM, 1L, 2, Plug, PlugS).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Ping interval is the time between the status pollings.</p>

    <h3>Inputs</h3>
    <p>Empty payload for getting the status. Or the following object for turning the switch on or off:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    relay : 0, </code>
        <br/>
        <code>    on : true </code>
        <br/>
        <code>}</code>
    </ul>
    <p>As an alternative you can also make use of the following notation:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    relay : 0, </code>
        <br/>
        <code>    turn : on/off/toggle </code>
        <br/>
        <code>}</code>
    </ul>

    <h3>Outputs</h3>
    <p>1. Standard Ouput: An array of relay status object.</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>[</code>
        <br/>
        <code>    { ison : false } </code>
        <br/>
        <code>    { ison : true } </code>
        <br/>
        <code>]</code>
    </ul>
    <p>Full status object is available at.</p>
    <p><code>msg.status</code></p>
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-door', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true  },
            description: { value:"" },
            usepolling: { value: true },
            pollinginterval: { value: 2000 },
            inputs: {value:0},
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 0,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "door",
        label: function () {
            return this.description || this.hostname || "Shelly door";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        },
        oneditprepare: function() {

            // the inputs edit field is always hidden.
            $("#hiddeninputs").hide();

             // polling on / off
             var usePolling = function() {
                var mode = $("#node-input-usepolling").prop('checked');
                if (mode === false) {
                    $("#polling").hide();
                    $("#hint").show();
                    $("#node-input-inputs").val(1);
                    $("#node-input-pollinginterval").val(3000);
                } else {
                    $("#polling").show();
                    $("#hint").hide();
                    $("#node-input-inputs").val(0);
                }
            };
            usePolling();
            $("#node-input-usepolling").change(usePolling);
        }
    });
</script>

<script type="text/x-red" data-template-name="shelly-door">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>

    <div class="form-row">
        <label for="node-input-usepolling"><i class="fa fa-clock"></i> Polling Mode</label>
        <input type="checkbox" id="node-input-usepolling" style="display: inline-block; width: auto; vertical-align: top;">
    </div>

    <div class="form-row" id="polling" style="background: #fbfbfb">
        <label style="width: auto"><i class="fa fa-cogs"></i> Polling Options:</label>

        <div class="form-row" style="background: #fff; margin-left: 20px">
            <div class="form-row">
                <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Polling Interval (ms)</label>
                <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds.)">
            </div>
        </div>
    </div>

    <div class="form-row" id="hint">
        <div class="form-tips" style="width: auto"><b>Note:</b> Polling support is standard. If you turn it off you must trigger the input manually.</div>
    </div>

    <div class="form-row" id="hiddeninputs">
        <label for="node-input-inputs"><i class="fa fa-poo"></i> Input Count</label>
        <input type="text" id="node-input-inputs">
    </div>

</script>

<script type="text/x-red" data-help-name="shelly-door">
    <p>A node that controls a shelly door device (Shelly Door, Window 1/2).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Send full status object is for debugging purposes. If this box is checked then you get the verbose response of the shelly sensor instead of a lightweight object.</p>
    <p>Polling mode can be turned off. But note that you will have to trigger the node via an external source e.g. an inject node.</p>
    <p>If polling is enabled you can control the polling time in milliseconds.</p>

    <h3>Inputs</h3>
    <p>The node has an input which triggers a status update request. It should only be trigger when polling mode is turned off.</p>

    <h3>Outputs</h3>
    <p>1. Standard Ouput: shelly status object.</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    sensor { state: "close", is_valid: true } </code>
        <br/>
        <code>    lux { value: 150, illumination: "twilight", is_valid: true } </code>
        <br/>
        <code>    bat { value: 100, voltage: 6.01 } </code>
        <br/>
        <code>}</code>
    </ul>
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-roller-shutter', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            pollinginterval: { value: 5000 },
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "roller shutter",
        label: function () {
            return this.description || this.hostname || "Shelly roller shutter";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-roller-shutter">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>
</script>

<script type="text/x-red" data-help-name="shelly-roller-shutter">
    <p>A node that controls a shelly roller shutter device (Shelly 2.5).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Ping interval is the time between the status pollings.</p>

    <h3>Inputs</h3>
    <p>Empty payload for getting the status. Or the following object for open or close the roller shutter:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    roller : 0, </code>
        <br/>
        <code>    go : "open" </code>
        <br/>
        <code>}</code>
        <br/>
        or
        <br/>
        <code>{</code>
        <br/>
        <code>    roller : 0, </code>
        <br/>
        <code>    go : "close" </code>
        <br/>
        <code>}</code>
        <br/>
        or
        <br/>
        <code>{</code>
        <br/>
        <code>    roller : 0, </code>
        <br/>
        <code>    go : "to_pos", </code>
        <br/>
        <code>    roller_pos : 50 </code>
        <br/>
        <code>}</code>
    </ul>

    <h3>Outputs</h3>
    <p>1. Standard Ouput: An array of relay status object.</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>[</code>
        <br/>
        <code>    { state : "close" } </code>
        <br/>
        or
        <br/>
        <code>    { state : "open" } </code>
        <br/>
        or
        <br/>
        <code>    { state : "open", current_pos: 50 } </code>
        <br/>
        <code>]</code>
    </ul>
    <p></p>
    <p>If the device type is set to relay use the following object for turning the switch on or off:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    relay : 0, </code>
        <br/>
        <code>    on : true </code>
        <br/>
        <code>}</code>
    </ul>
    <p>As an alternative you can also make use of the following notation:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    relay : 0, </code>
        <br/>
        <code>    turn : on/off/toggle </code>
        <br/>
        <code>}</code>
    </ul>
    <p>Full status object is available at.</p>
    <p><code>msg.status</code></p>
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-dimmer', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
	        dimmerStat: { value: true },
            pollinginterval: { value: 5000 },
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "dimmer/bulb duo",
        label: function () {
            return this.description || this.hostname || "Shelly dimmer";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-dimmer">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-dimmerStat"><i class="fa fa-share"></i> Status</label>
        <input type="checkbox" id="node-input-dimmerStat" style="display: inline-block; width: auto; vertical-align: top"> Enable status output after each command
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>

</script>

<script type="text/x-red" data-help-name="shelly-dimmer">
    <p>A node that controls a shelly dimmer (Shelly Dimmer 1/2, Shelly Bulb Duo, Vintage)).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Status enables a node status payload following every command.</p>
    <p>Ping interval is the time between the status pollings.</p>

    <h3>Inputs</h3>
    <p>Empty payload for getting the status. Or the following object for turning the dimmer on or off:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    light : 0, </code>
        <br/>
        code>    on : true, </code>
        <br/>
        <code>   brightness: 75, </code>
        <br/>
        <code>   white: 100, </code>
        <br/>
        <code>   temp: 2700, </code>
        <br/>
        <code>   transition: 0, </code>
        <br/>
        <code>}</code>
    </ul>
    <p>white = 0..100 is optional for shelly bulb duo.</p>
    <p>temp = 2700..6500 means temperature of white which is supported by the shelly bulb duo. Use temp or white as both are the same.</p>
    <p>transition = 0..5000ms the transition is optional for shelly bulb duo.</p>
    <p>brightness = 0..100% the brightness is optional for shelly bulb duo.</p>
    <p></p>
    <p>As an alternative you can also make use of the following notation:</p>
    <ul>
        <code>{</code>
        <br/>
        <code>    light : 0, </code>
        <br/>
        <code>    turn : on/off/toggle, </code>
        <br/>
        <code>   brightness: 75, </code>
        <br/>
        <code>}</code>
    </ul>

    <h3>Outputs</h3>
    <p>1. Standard Ouput: An array of light status object.</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>[</code>
        <br/>
        <code>    { ison : false } </code>
        <br/>
        <code>    { ison : true } </code>
        <br/>
        <code>]</code>
    </ul>
    <p>Full status object is available at.</p>
    <p><code>msg.status</code></p>
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-rgbw2', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            ledStat: { value: true },
            pollinginterval: { value: 5000 },
            mode: { value:"color", required: true  },
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "rgbw2/bulb rgbw",
        label: function () {
            return this.description || this.hostname || "Shelly RGBW";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-rgbw2">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-ledStat"><i class="fa fa-share"></i> Status</label>
        <input type="checkbox" id="node-input-ledStat" style="display: inline-block; width: auto; vertical-align: top"> Enable status output after each command
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>

    <hr align="middle"/>

    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-pencil"></i> Device Type</label>
        <div style="display: inline-block; position: relative; width: 70%; height: 19.1333px;">
        <div style="position: absolute; left: 0; right: 0;">
          <select id="node-input-mode" style="width:100%">
            <option value="color">Color - Shelly controls Red, Blue, Green and White LED stripes</option>
            <option value="white">White - Shelly controls 4x White LED stripes</option>
          </select>
        </div>
        </div>
    </div>

</script>

<script type="text/x-red" data-help-name="shelly-rgbw2">
    <p>A node that controls a shelly RGBW device (Shelly RGBW2, Shelly Bulb RGBW).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Status enables a node status payload following every command.</p>
    <p>Ping interval is the time between the status pollings.</p>

    <h3>Inputs</h3>
    <p>Empty payload for getting the status. Or the following object for turning the switch on or off:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    red : 255, </code>
        <br/>
        <code>    green : 255, </code>
        <br/>
        <code>    blue : 255, </code>
        <br/>
        <code>    white : 255, </code>
        <br/>
        <code>    temp : 4750, </code>
        <br/>
        <code>    gain : 100, </code>
        <br/>
        <code>    effect : 0, </code>
        <br/>
        <code>    on : true, </code>
        <br/>
        <code>    timer : 0, </code>
        <br/>
        <code>    mode : 'color', </code>
        <br/>
        <code>    transition : 0, </code>
        <br/>
        <code>    brightness : 100, </code>
        <br/>
        <code>}</code>
    </ul>
    <p>Values or colors must be betweem 0..255.</p>
    <p>Value of gain must be between 0..100.</p>
    <p>temp = 3000..6500 means temperature of white which is supported by the shelly bulb RGBW. Either use temp or white as both are the same.</p>
    <p>effect = 0 is default means that no effect is used.</p>
    <p>timer = 0 time in seconds to flip back. 0 is default means that no flip back is used.</p>
    <p>mode = 'color' the mode is optional and can either be passed in the payload or set in the node configuration itself.</p>
    <p>transition = 0..5000ms the transition is optional.</p>
    <p>brightness = 0..100% the brightness is optional.</p>
    <p> or </p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    light : 0, </code>
        <br/>
        <code>    brightness : 100, </code>
        <br/>
        <code>    on : true, </code>
        <br/>
        <code>    timer : 0, </code>
        <br/>
        <code>    mode : 'white', </code>
        <br/>
        <code>    transition : 0< /code>
        <br/>
        <code>}</code>
    </ul>
    <p>light = 0..3 the light (0 for shelly bulb duo).</p>

    <h3>Outputs</h3>
    <p>1. Standard Ouput: A status object.</p>
    <p><code>msg.payload</code></p>
    <p>Full status object is available at.</p>
    <p><code>msg.status</code></p>
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-motion', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            pollinginterval: { value: 1000 },
            hasextraoutputs: { value: false, required: false },
            outputs: {value: 1}
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "motion",
        label: function () {
            return this.description || this.hostname || "Shelly motion";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
            // hasextraoutputs on / off
            var hasextraoutputs = function() {
                var mode = $("#node-input-hasextraoutputs").prop('checked');
                if (mode === true) {
                    that.outputs = 3;
                } else {
                    that.outputs = 1;
                }
            };
            hasextraoutputs();
            $("#node-input-hasextraoutputs").change(hasextraoutputs);
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-motion">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>

    <hr align="middle"/>

    <div class="form-row">
        <label for="node-input-hasextraoutputs"><i class="fa fa-flash"></i> Enable extra outputs for motion and vibration.</label>
        <input type="checkbox" id="node-input-hasextraoutputs" style="display: inline-block; width: auto; vertical-align: top;">
    </div>
</script>

<script type="text/x-red" data-help-name="shelly-motion">
    <p>A node that controls a shelly motion device (Shelly Motion).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Ping interval is the time between the status pollings.</p>
    <p>Enable extra outputs for motion and vibration is optional when you want an extra output that is triggered for motion and vibration.</p>
    <p>Send full status object is optional when you want to see the raw response at the output.</p>

    <h3>Inputs</h3>
    <p>Empty payload for getting the status.</p>
    
    <h3>Outputs</h3>
    <p>1. Standard Ouput: A status object.</p>
    <p><code>msg.payload</code></p>
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-emeasure', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            pollinginterval: { value: 1000 },
            outputs: {value: 2}
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 2,
        icon: "shelly.png",
        paletteLabel: "emeasure",
        label: function () {
            return this.description || this.hostname || "Shelly EM";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-emeasure">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>
</script>

<script type="text/x-red" data-help-name="shelly-emeasure">
    <p>A node that controls a shelly EM device (Shelly EM, 3EM).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Ping interval is the time between the status pollings.</p>
   
    <h3>Inputs</h3>
    <p>Empty payload for getting the status.</p>
    
    <h3>Outputs</h3>
    <p>1. Standard Ouput: A status object.</p>
    <p><code>msg.payload</code></p>
    <p>Full status object is available at.</p>
    <p><code>msg.status</code></p>
    <p></p>
    <p>2. CSV Ouput: The downloaded csv history.</p>
    <p><code>msg.payload</code></p>
    
</script>


<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-uni', {
        category: 'Shelly Gen 1',
        color: '#319DD7',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            pollinginterval: { value: 1000 },
            outputs: {value: 1}
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly.png",
        paletteLabel: "uni",
        label: function () {
            return this.description || this.hostname || "Shelly UNI";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-uni">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>
</script>

<script type="text/x-red" data-help-name="shelly-uni">
    <p>A node that controls a shelly UNI device (Shelly UNI).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Ping interval is the time between the status pollings.</p>
   
    <h3>Inputs</h3>
    <p>Empty payload for getting the status.</p>
    
    <h3>Outputs</h3>
    <p>1. Standard Ouput: A status object.</p>
    <p><code>msg.payload</code></p>
    <p>Full status object is available at.</p>
    <p><code>msg.status</code></p>
</script>


<!-- GEN 2 ------------------------------------------------------------------------------------ -->

<!-- ------------------------------------------------------------------------------------------ -->
<script type="text/javascript">
    RED.nodes.registerType('shelly-switch2', {
        category: 'Shelly Gen 2',
        color: '#6C95CE',
        defaults: {
            hostname: { value:"", required:true },
            description: { value:"" },
            pollinginterval: { value: 5000 },
        },
        credentials: {
            username: { type: "text" },
            password: { type: "password" },
        },
        inputs: 1,
        outputs: 1,
        icon: "shelly2.png",
        paletteLabel: "switch2",
        label: function () {
            return this.description || this.hostname || "Shelly switch 2";
        },
        labelStyle: function() {
            return this.description?"node_label_italic":"";
        }
    });

</script>

<script type="text/x-red" data-template-name="shelly-switch2">
    <div class="form-row">
        <label for="node-input-hostname"><i class="fa fa-tag"></i> Hostname</label>
        <input type="text" id="node-input-hostname" placeholder="The hostname or the IP address of the device">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-comment"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="The description of the device (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Enter the username here (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="text" id="node-input-password" placeholder="Enter the password here (optional))">
    </div>
    <div class="form-row">
        <label for="node-input-pollinginterval"><i class="fa fa-clock-o"></i> Ping Interval (ms)</label>
        <input type="text" id="node-input-pollinginterval" placeholder="(Time in milliseconds. 0=off)">
    </div>
</script>

<script type="text/x-red" data-help-name="shelly-switch2">
    <p>A node that controls a shelly switch device (Shelly Plus 1, Shelly Plus 1 PM).</p>

    <h3>Configuration</h3>
    <p>Hostname is the IP address or the hostname of the device.</p>
    <p>Description of the device.</p>
    <p>User is optional and must only be set if security is enabled.</p>
    <p>Password is optional and must only be set if security is enabled.</p>
    <p>Ping interval is the time between the status pollings.</p>

    <h3>Inputs</h3>
    <p>Empty payload for getting the status. Or the following object for turning the switch on or off:</p>
    <p><code>msg.payload</code></p>
    <ul>
        <code>{</code>
        <br/>
        <code>    id : 0, </code>
        <br/>
        <code>    on : true </code>
        <br/>
        <code>    toggle_after : 1 </code>
        <br/>
        <code>}</code>
    </ul>
    <p>id is the relay 0..n.</p>
    <p>on can be true or false.</p>
    <p>toggle_after is optional time in seconds to flip back.</p>

    <h3>Outputs</h3>
    <p>1. Standard Ouput: The full status object.</p>
    <p><code>msg.payload</code></p>
</script>

